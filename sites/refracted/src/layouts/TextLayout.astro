---
import { sortArticles } from "../../public/scripts/sortArticles.ts";

import RyojiLayout from "./RyojiLayout.astro";

const articles = await sortArticles();

const currentPath = Astro.url.pathname.replace(/^\/|\/$/g, ""); // remove leading/trailing slashes
const currentPostIndex = articles.findIndex((article) => article.id === currentPath);
const prevPost = currentPostIndex > 0 ? articles[currentPostIndex - 1] : undefined;
const nextPost = currentPostIndex < articles.length - 1 ? articles[currentPostIndex + 1] : undefined;

const { frontmatter } = Astro.props;
---
<RyojiLayout title={frontmatter.title}>
    <section class="col-12">
        <h2 class="focus">{frontmatter.title}</h2>
        <slot/>

        <nav class="article-jump pt-5 px-5">
            {prevPost && <span class="float-start">&#8249; <a href={`/${prevPost.id}`}>{prevPost.data.title}</a></span>}
            {nextPost && <span class="float-end"><a href={`/${nextPost.id}`}>{nextPost.data.title}</a> &#8250; </span>}
        </nav>
    </section>
</RyojiLayout>